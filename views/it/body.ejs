<!DOCTYPE html>
<html lang="en" translate="no">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex,nofollow">
    <title>
        <%= titlepage %>
    </title>

    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css">

    <link rel="stylesheet" href="<%=czz%>">
    <link rel="stylesheet" href="/css/skeleton.css<%=versionall %>">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/litepicker/dist/css/litepicker.css" />
</head>

<body>

    <!-- Header (selalu tampil) -->
    <header class="navbar navbar-dark">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <a class="navbar-brand" href="#">
                <i class="bi bi-speedometer2"></i> KHUSUS TIM SUKSES
            </a>
            <button class="navbar-toggler d-lg-none" type="button" id="sidebarToggleBtn">
                <i class="bi bi-list fs-3"></i>
            </button>
        </div>
    </header>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebarMenu">
        <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link active" href="/babilonia"><i class="bi bi-house-door me-2"></i>
                    Dashboard</a>
            </li>
            <li class="nav-item"><a class="nav-link" href="/babilonia/adminlistdata"><i class="bi bi-table me-2"></i>
                    Admin List Transaction</a></li>
            <li class="nav-item"><a class="nav-link" href="/babilonia/adminweb-transaction"><i class="bi bi-table me-2"></i>
                    Admin Web Transaction</a></li>
            <li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-box-seam me-2"></i> Products</a></li>
            <li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-people me-2"></i> Customers</a></li>
            <li class="nav-item"><a class="nav-link" href="#"><i class="bi bi-graph-up me-2"></i> Reports</a></li>
            <!-- ðŸ”¹ Logout -->
            <li class="nav-item mt-3 border-top pt-2">
                <a class="nav-link text-danger fw-semibold" href="#" id="logoutSidebar">
                    <i class="bi bi-box-arrow-right me-2"></i> Logout
                </a>
            </li>
        </ul>
    </div>

    <!-- Overlay -->
    <div class="sidebar-overlay"></div>

    <!-- Main Content -->
    <main class="content">
        <div class="">
            <%- include(body) %>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        &copy; <span id="year"></span> MyDashboard. All rights reserved.
    </footer>

    <!-- Select2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.15.10/dist/sweetalert2.all.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/litepicker/dist/litepicker.js"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.socket.io/4.8.1/socket.io.min.js"
        integrity="sha384-mkQ3/7FUtcGyoppY6bz/PORYoGqOl7/aSUMn2ymDOJcapfS6PHqxhRTMh1RR0Q6+"
        crossorigin="anonymous"></script>
    <script>
        document.getElementById("year").textContent = new Date().getFullYear();
    </script>
    <script>
        const sidebar = document.getElementById('sidebarMenu');
        const overlay = document.querySelector('.sidebar-overlay');
        const toggleBtn = document.getElementById('sidebarToggleBtn');

        // Sidebar toggle (mobile)
        toggleBtn?.addEventListener('click', () => {
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
            document.body.classList.toggle('no-scroll');
        });

        overlay?.addEventListener('click', () => {
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
            document.body.classList.remove('no-scroll');
        });

        // âœ… Highlight aktif berdasarkan URL
        const currentPath = window.location.pathname;
        document.querySelectorAll('#sidebarMenu .nav-link').forEach(link => {
            // Cocokkan URL aktif (tanpa query params)
            if (link.getAttribute('href') === currentPath) {
                link.classList.add('active');
            } else {
                link.classList.remove('active');
            }

            // Bonus UX: klik link di mobile â†’ auto tutup sidebar
            link.addEventListener('click', () => {
                if (window.innerWidth < 992) {
                    sidebar.classList.remove('active');
                    overlay.classList.remove('active');
                    document.body.classList.remove('no-scroll');
                }
            });
        });

        // âœ… Fungsi Logout
        document.getElementById('logoutSidebar')?.addEventListener('click', (e) => {
            e.preventDefault();
            Swal.fire({
                title: "",
                text: 'Anda ingin logout akun?',
                showDenyButton: true,
                //showCancelButton: true,
                confirmButtonText: "Ya",
                denyButtonText: `Tidak`
            }).then(async (result) => {
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    suksesandloading('success', 'Logout sukses');

                    if (localStorage.getItem('ismobile') == 'y') {
                        var datum = JSON.parse(await dbs.get('datauser'));
                        var no = datum.no;
                        var userid = datum.username
                        const response = await window.flutter_inappwebview.callHandler('fromWebLogout', { no, username: userid });
                    }


                    localStorage.clear();
                    sessionStorage.clear();
                    await hapusAlldbs();//await dbs.deleteDatabase();
                    document.cookie = `hamburger=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/`;

                    window.open('/login', '_self');
                }
            });

        });

    </script>


    <script type="text/javascript">
        var versionapp = 'v5.0.1';
    </script>

    <script>
        // Membuat elemen banner
        const banner = document.createElement("div");
        banner.classList.add("testing-mode-banner");
        banner.innerText = "TESTING MODE";

        // Menambahkan banner ke body
        document.body.appendChild(banner);
    </script>
    <script>const socket = io();</script>
    <script src="/js/zindexeddb-helper.js<%=versionall%>"></script>
    <script src="/js/<%=jzz%>.js<%=versionall%>"></script>
    <script src="/js/zuniversal.js<%=versionall%>"></script>
    <script src="/js/it/utils.js<%=versionall%>"></script>


    <!-- SortableJS CDN (needed for drag & drop) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
</body>

</html>